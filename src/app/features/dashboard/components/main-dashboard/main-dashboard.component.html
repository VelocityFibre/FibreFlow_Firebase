<div class="ff-page-container">
  <div class="ff-page-header">
    <div class="header-content">
      <h1 class="page-title">Dashboard</h1>
      <p class="page-subtitle">
        Welcome to FibreFlow. Quick access to all your project management tools.
      </p>
    </div>
    <div class="header-actions">
      <button mat-icon-button (click)="refreshDashboard()" matTooltip="Refresh dashboard data">
        <mat-icon>refresh</mat-icon>
      </button>
    </div>
  </div>

  <!-- Loading State -->
  @if (isLoading()) {
    <div class="loading-container">
      <mat-card class="loading-card">
        <div class="loading-content">
          <mat-icon class="loading-spinner">hourglass_empty</mat-icon>
          <p>Loading dashboard data...</p>
        </div>
      </mat-card>
    </div>
  } @else {
    <!-- Main Dashboard Cards -->
    <div class="dashboard-grid">
      <!-- Projects Card -->
      <mat-card class="dashboard-card" routerLink="/projects">
        <mat-card-content>
          <div class="card-icon projects-icon">
            <mat-icon>folder</mat-icon>
          </div>
          <div class="card-details">
            <h3 class="card-title">Projects</h3>
            <p class="card-subtitle">Manage and track all projects</p>
            <div class="card-stats">
              <span class="stat-number">{{ projectsCount() }}</span>
              <span class="stat-label">Total Projects</span>
            </div>
          </div>
        </mat-card-content>
      </mat-card>

      <!-- Suppliers Card -->
      <mat-card class="dashboard-card" routerLink="/suppliers">
        <mat-card-content>
          <div class="card-icon suppliers-icon">
            <mat-icon>business</mat-icon>
          </div>
          <div class="card-details">
            <h3 class="card-title">Suppliers</h3>
            <p class="card-subtitle">Supplier management and contacts</p>
            <div class="card-stats">
              <span class="stat-number">{{ suppliersCount() }}</span>
              <span class="stat-label">Total Suppliers</span>
            </div>
          </div>
        </mat-card-content>
      </mat-card>

      <!-- RFQ Card (formerly Stock Card) -->
      <mat-card class="dashboard-card" routerLink="/quotes/rfq">
        <mat-card-content>
          <div class="card-icon stock-icon">
            <mat-icon>request_quote</mat-icon>
          </div>
          <div class="card-details">
            <h3 class="card-title">RFQ's</h3>
            <p class="card-subtitle">Request for Quotations</p>
            <div class="card-stats">
              <span class="stat-number">{{ rfqsCount() }}</span>
              <span class="stat-label">Active RFQs</span>
            </div>
          </div>
        </mat-card-content>
      </mat-card>

      <!-- Clients Card -->
      <mat-card class="dashboard-card" routerLink="/clients">
        <mat-card-content>
          <div class="card-icon clients-icon">
            <mat-icon>groups</mat-icon>
          </div>
          <div class="card-details">
            <h3 class="card-title">Clients</h3>
            <p class="card-subtitle">Client information and projects</p>
            <div class="card-stats">
              <span class="stat-number">{{ clientsCount() }}</span>
              <span class="stat-label">Total Clients</span>
            </div>
          </div>
        </mat-card-content>
      </mat-card>

      <!-- Staff Card -->
      <mat-card class="dashboard-card" routerLink="/staff">
        <mat-card-content>
          <div class="card-icon staff-icon">
            <mat-icon>badge</mat-icon>
          </div>
          <div class="card-details">
            <h3 class="card-title">Staff</h3>
            <p class="card-subtitle">Staff members and management</p>
            <div class="card-stats">
              <span class="stat-number">{{ staffCount() }}</span>
              <span class="stat-label">Total Staff</span>
            </div>
          </div>
        </mat-card-content>
      </mat-card>

      <!-- Contractors Card -->
      <mat-card class="dashboard-card" routerLink="/contractors">
        <mat-card-content>
          <div class="card-icon contractors-icon">
            <mat-icon>engineering</mat-icon>
          </div>
          <div class="card-details">
            <h3 class="card-title">Contractors</h3>
            <p class="card-subtitle">Contractor management and projects</p>
            <div class="card-stats">
              <span class="stat-number">{{ contractorsCount() }}</span>
              <span class="stat-label">Total Contractors</span>
            </div>
          </div>
        </mat-card-content>
      </mat-card>

      <!-- Pole Tracker Card -->
      <mat-card class="dashboard-card" routerLink="/pole-tracker">
        <mat-card-content>
          <div class="card-icon poles-icon">
            <mat-icon>cell_tower</mat-icon>
          </div>
          <div class="card-details">
            <h3 class="card-title">Poles Installed</h3>
            <p class="card-subtitle">Fiber optic pole installation tracking</p>
            <div class="card-stats">
              <span class="stat-number">{{ polesInstalledCount() }}</span>
              <span class="stat-label">Poles Installed</span>
            </div>
          </div>
        </mat-card-content>
      </mat-card>

      <!-- Flagged Issues Card -->
      <mat-card class="dashboard-card" routerLink="/projects">
        <mat-card-content>
          <div class="card-icon issues-icon">
            <mat-icon>flag</mat-icon>
          </div>
          <div class="card-details">
            <h3 class="card-title">Flagged Issues</h3>
            <p class="card-subtitle">High priority tasks requiring attention</p>
            <div class="card-stats">
              <span class="stat-number">{{ flaggedIssuesCount() }}</span>
              <span class="stat-label">Flagged Tasks</span>
            </div>
          </div>
        </mat-card-content>
      </mat-card>

      <!-- Tasks Card -->
      <mat-card class="dashboard-card" routerLink="/tasks/management">
        <mat-card-content>
          <div class="card-icon tasks-icon">
            <mat-icon>task_alt</mat-icon>
          </div>
          <div class="card-details">
            <h3 class="card-title">Tasks</h3>
            <p class="card-subtitle">Manage and track all tasks</p>
            <div class="card-stats">
              <span class="stat-number">{{ outstandingTasksCount() }}</span>
              <span class="stat-label">Outstanding</span>
            </div>
          </div>
        </mat-card-content>
      </mat-card>

    </div>

    <!-- Quick Summary Section -->
    <div class="summary-section">
      <h2 class="section-title">Quick Summary</h2>
      <div class="summary-cards">
        <mat-card class="summary-card">
          <mat-card-content>
            <div class="card-icon success-icon">
              <mat-icon>trending_up</mat-icon>
            </div>
            <div class="card-info">
              <div class="card-value">{{ dashboardStats().polesPlanted }}</div>
              <div class="card-label">Tasks Completed</div>
              <div class="card-detail">Across all projects</div>
            </div>
          </mat-card-content>
        </mat-card>

        <mat-card class="summary-card">
          <mat-card-content>
            <div class="card-icon warning-icon">
              <mat-icon>construction</mat-icon>
            </div>
            <div class="card-info">
              <div class="card-value">{{ dashboardStats().materialsNeeded }}</div>
              <div class="card-label">Materials Needed</div>
              <div class="card-detail">Below minimum stock</div>
            </div>
          </mat-card-content>
        </mat-card>

        <mat-card class="summary-card">
          <mat-card-content>
            <div class="card-icon info-icon">
              <mat-icon>folder_open</mat-icon>
            </div>
            <div class="card-info">
              <div class="card-value">{{ dashboardStats().activeProjects }}</div>
              <div class="card-label">Active Projects</div>
              <div class="card-detail">Currently running</div>
            </div>
          </mat-card-content>
        </mat-card>

        <mat-card class="summary-card">
          <mat-card-content>
            <div class="card-icon primary-icon">
              <mat-icon>check_circle</mat-icon>
            </div>
            <div class="card-info">
              <div class="card-value">{{ dashboardStats().completionRate }}%</div>
              <div class="card-label">Completion Rate</div>
              <div class="card-detail">Project completion</div>
            </div>
          </mat-card-content>
        </mat-card>
      </div>
    </div>

    <!-- Recent Activity -->
    <div class="activity-section">
      <h2 class="section-title">Recent Activity</h2>
      <mat-card>
        <mat-card-content>
          <div class="activity-list-container">
            <div class="activity-list">
              <div class="activity-item">
                <mat-icon class="activity-icon">check_circle</mat-icon>
                <div class="activity-content">
                  <p><strong>Project "Fiber Installation - Downtown"</strong> completed Phase 2</p>
                  <span class="activity-time">5 hours ago</span>
                </div>
              </div>
              <div class="activity-item">
                <mat-icon class="activity-icon">warning</mat-icon>
                <div class="activity-content">
                  <p>Low stock alert: Fiber Optic Cable (Single Mode)</p>
                  <span class="activity-time">1 day ago</span>
                </div>
              </div>
            </div>
          </div>
        </mat-card-content>
      </mat-card>
    </div>
  }
</div>
