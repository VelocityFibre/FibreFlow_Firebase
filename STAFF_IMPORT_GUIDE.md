# Staff Import Guide for FibreFlow

## Overview
This guide provides the template and field specifications for importing staff data into FibreFlow using the CSV import feature. It includes instructions for converting Excel files to the required CSV format.

## Quick Start - Import from Excel

1. **Prepare Excel file** with columns: Name, Job Title, Email
2. **Convert to CSV**: Run `node analyze-staff-excel.js`
3. **Import**: Navigate to Staff page and use Import dialog
4. **Review**: Check imported data and update as needed

## How to Use Import Feature

1. Navigate to: https://fibreflow-73daf.web.app/staff
2. Click the "Import Staff" button in the top right
3. The import dialog will open with options to:
   - Download a template CSV file
   - Upload your prepared CSV file
   - Review validation results before importing

## CSV Import Template

### Required Fields

| Field Name | Type | Required | Description | Example |
|------------|------|----------|-------------|---------|
| **employeeId** | String | Yes | Unique employee identifier | VF001 |
| **name** | String | Yes | Full name of employee | John Doe |
| **email** | String | Yes | Valid email address | john.doe@example.com |
| **phone** | String | Yes | Phone number with country code | +27 82 123 4567 |
| **primaryGroup** | String | Yes | Staff group classification | ProjectManager |
| **position** | String | No | Job position/title | Project Manager |
| **roleId** | String | No | System role identifier | pm |

### Optional Fields

| Field Name | Type | Required | Description | Example |
|------------|------|----------|-------------|---------|
| **skills** | String | No | Comma-separated skills | "Project Management,Leadership" |
| **certifications** | String | No | Comma-separated certifications | "PMP,Prince2" |
| **emergencyContactName** | String | No | Emergency contact name | Jane Doe |
| **emergencyContactPhone** | String | No | Emergency contact phone | +27 82 987 6543 |
| **emergencyContactRelationship** | String | No | Relationship to employee | Spouse |

## Field Type Specifications

### primaryGroup (Required)
Valid values:
- `Admin` - Administrative staff
- `ProjectManager` - Project managers
- `Technician` - Field technicians and engineers
- `Supplier` - Supplier representatives
- `Client` - Client representatives

### roleId (Optional)
Valid system role IDs:
- `senior-management` - Senior Management
- `rpm` - Regional Project Manager
- `pm` - Project Manager
- `clo` - Chief Logistics Officer
- `engineer` - Engineer
- `site-supervisor` - Site Supervisor
- `admin` - Administrator

### Phone Numbers
Format: Include country code (e.g., +27 for South Africa)
Examples:
- `+27 82 123 4567`
- `+27 83 234 5678`
- `082 123 4567` (without country code)

### Skills and Certifications
Format: Comma-separated values in quotes
Examples:
- `"Project Management,Leadership,Team Building"`
- `"Fiber Optic Installation,Cable Splicing,Safety"`
- `"PMP,Prince2,Agile Certification"`

## Template File

A sample CSV template file is provided: `staff-import-template.csv`

```csv
employeeId,name,email,phone,primaryGroup,position,roleId,skills,certifications,emergencyContactName,emergencyContactPhone,emergencyContactRelationship
VF001,John Doe,john.doe@example.com,+27 82 123 4567,ProjectManager,Project Manager,pm,"Project Management,Leadership","PMP,Prince2",Jane Doe,+27 82 987 6543,Spouse
VF002,Jane Smith,jane.smith@example.com,+27 83 234 5678,Technician,Field Technician,engineer,"Fiber Optic Installation,Cable Splicing","Fiber Optic Certification,Safety Training",John Smith,+27 83 876 5432,Spouse
```

## Auto-Generated Fields

The following fields are automatically generated by the system:
- `id` - Document ID (auto-generated)
- `isActive` - Set to `true` by default
- `createdAt` - Current timestamp
- `updatedAt` - Current timestamp
- `createdBy` - Current user ID
- `availability` - Default availability object
- `activity` - Default activity tracking object

## Validation Rules

1. **Employee ID**: Must be unique across all staff members
2. **Email**: Must be valid email format and unique
3. **Phone**: Should include country code
4. **Primary Group**: Must match one of the valid values
5. **Role ID**: Must exist in the system or be empty

## Common Issues

### Import Fails
- Check that all required fields are present
- Verify primaryGroup values are valid
- Ensure employeeId is unique
- Check email format is valid

### Data Not Showing
- Refresh the page after import
- Check browser console for errors
- Verify Firebase connection

## Testing Import

1. Download the template file
2. Modify with your staff data
3. Save as CSV format
4. Upload through the import dialog
5. Review validation results
6. Confirm import if validation passes

## Excel to CSV Conversion

### Using the Conversion Script

The `analyze-staff-excel.js` script converts Excel files to import-ready CSV:

1. **Place Excel file** in FibreFlow directory (e.g., `VF_Staff.xlsx`)
2. **Run conversion**:
   ```bash
   node analyze-staff-excel.js
   ```
3. **Output**: Creates `staff-import-ready.csv`

### What the Script Does
- Reads Excel columns (Name, Job Title, Email)
- Generates unique employee IDs (VF001, VF002, etc.)
- Auto-assigns groups based on job titles
- Creates placeholder phone numbers
- Validates data and reports issues

### Group Assignment Logic
- **Admin**: Job titles containing "admin" or "assistant"
- **ProjectManager**: Job titles containing "manager" or "pm"
- **Technician**: Default for all other job titles
- **Supplier**: Job titles containing "supplier"
- **Client**: Job titles containing "client"

## Import Results

### Successfully Imported Data (from VF_Staff.xlsx)
- **Total Staff**: 29 valid records imported
- **Groups**: 
  - Admin: 3 staff
  - ProjectManager: 8 staff
  - Technician: 18 staff

### Records Requiring Review
The following entries had issues and need manual cleanup:
- Row 17: "IC's" - Missing email
- Row 18: "Name" placeholder - Invalid entry
- Row 29: "Management" - Missing email
- Row 30: "Name" placeholder - Invalid entry
- Row 34: "VEA Group" - Missing email

## Support

For issues with the import feature:
1. Check browser console for errors
2. Verify CSV format matches template
3. Ensure all required fields are present
4. Review the conversion script output for validation errors
5. Contact system administrator if problems persist

## Files Reference
- **Excel Input**: `VF_Staff.xlsx`
- **Conversion Script**: `analyze-staff-excel.js`
- **CSV Output**: `staff-import-ready.csv`
- **Template**: `staff-import-template.csv`